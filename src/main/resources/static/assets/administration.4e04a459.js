import{m as x,u as L,_ as w,r as t,o,a as u,w as n,b as r,g as c,h as S,F as $,k as T,t as b,f as C,e as V,j as A,x as q,l as B,K as M,n as U,p as P,q as j,s as K,v as N}from"./http.util.137d7046.js";const R={name:"TicketList",data(){return{ticketList:[],loading:!1,page:1,length:0}},async created(){this.loadTickets()},computed:{...x(L)},methods:{openTicketDetails(e){this.currentItemStore.setLoading(!0),this.currentItemStore.setCurrentItem(e)},async loadTickets(){this.loading=!0;const{data:e}=await this.$http.get(`/api/supportticket/all?page=${this.page}&size=10`);this.ticketList=e.content,this.length=e.totalPages,this.loading=!1}}},z=c("thead",null,[c("tr",null,[c("th",{class:"text-left"}),c("th",{class:"text-left"},"Title"),c("th",{class:"text-left"},"Status"),c("th",{class:"text-left"},"Closed")])],-1);function E(e,l,s,v,d,i){const f=t("v-progress-circular"),_=t("v-icon"),h=t("v-table"),g=t("v-pagination"),m=t("v-card");return o(),u(m,{title:"Tickets",variant:"tonal"},{default:n(()=>[r(h,{"fixed-header":"",height:"300px"},{default:n(()=>[z,c("tbody",null,[(o(!0),S($,null,T(d.ticketList,a=>(o(),S("tr",{key:a.name},[c("td",null,[e.currentItemStore.loading?(o(),u(f,{key:0,indeterminate:""})):(o(),u(_,{key:1,icon:"mdi-file-document",onClick:I=>i.openTicketDetails(a)},null,8,["onClick"]))]),c("td",null,b(a.title),1),c("td",null,b(a.status),1),c("td",null,b(a.isClosed),1)]))),128))])]),_:1}),r(g,{modelValue:d.page,"onUpdate:modelValue":[l[0]||(l[0]=a=>d.page=a),e.loadVehicles],length:d.length},null,8,["modelValue","length","onUpdate:modelValue"])]),_:1})}const F=w(R,[["render",E]]),O={name:"VehiclesList",data(){return{vehicleList:[],loading:!1,page:1,length:0}},async created(){this.loadVehicles()},computed:{...x(L)},methods:{openTicketDetails(e){this.currentItemStore.setLoading(!0),this.currentItemStore.setCurrentItem(e)},async loadVehicles(){this.loading=!0;const{data:e}=await this.$http.get(`/api/vehicle?page=${this.page-1}&size=10`);this.vehicleList=e.content,this.length=e.totalPages,this.loading=!1}}},H=c("thead",null,[c("tr",null,[c("th",{class:"text-left"}),c("th",{class:"text-left"},"Make"),c("th",{class:"text-left"},"Model"),c("th",{class:"text-left"},"Status")])],-1);function G(e,l,s,v,d,i){const f=t("v-progress-circular"),_=t("v-icon"),h=t("v-table"),g=t("v-pagination"),m=t("v-card");return o(),u(m,{title:"Vehicles",variant:"tonal"},{default:n(()=>[r(h,{"fixed-header":"",height:"300px"},{default:n(()=>[H,c("tbody",null,[(o(!0),S($,null,T(d.vehicleList,a=>(o(),S("tr",{key:a.name},[c("td",null,[e.currentItemStore.loading?(o(),u(f,{key:0,indeterminate:""})):(o(),u(_,{key:1,icon:"mdi-car-info",onClick:I=>i.openTicketDetails(a)},null,8,["onClick"]))]),c("td",null,b(a.make),1),c("td",null,b(a.model),1),c("td",null,b(a.status),1)]))),128))])]),_:1}),r(g,{modelValue:d.page,"onUpdate:modelValue":[l[0]||(l[0]=a=>d.page=a),i.loadVehicles],length:d.length},null,8,["modelValue","length","onUpdate:modelValue"])]),_:1})}const J=w(O,[["render",G]]),Q={updated(){this.currentItemStore.setLoading(!1)},computed:{...x(L),currentItemSet:function(){return this.currentItemStore.currentItem.id!==void 0&&this.currentItemStore.currentItem.title}},methods:{isSingleLine(e){return e.indexOf(`
`)===-1},async closeTicket(){let e=this.currentItemStore.currentItem;e.isClosed=!0,this.currentItemStore.setCurrentItem(e),await this.$http.patch("/api/supportticket/update",e)}}},W={class:"text-center d-flex align-center"};function X(e,l,s,v,d,i){const f=t("v-text-field"),_=t("v-textarea"),h=t("v-col"),g=t("v-card-text"),m=t("v-btn"),a=t("v-card-actions"),I=t("v-card"),D=t("v-dialog");return o(),S("div",W,[r(D,{modelValue:i.currentItemSet,"onUpdate:modelValue":l[1]||(l[1]=p=>i.currentItemSet=p),class:"w-25"},{default:n(()=>[r(I,null,{default:n(()=>[r(g,null,{default:n(()=>[(o(!0),S($,null,T(e.currentItemStore.currentItem,(p,k)=>(o(),u(h,{key:k},{default:n(()=>[i.isSingleLine(String(p))&&k!=="id"?(o(),u(f,{key:0,"model-value":String(p),variant:"outlined",label:k,readonly:""},null,8,["model-value","label"])):k!=="id"?(o(),u(_,{key:1,variant:"outlined","model-value":p,label:k,readonly:""},null,8,["model-value","label"])):C("",!0)]),_:2},1024))),128))]),_:1}),r(a,null,{default:n(()=>[e.currentItemStore.currentItem.status!=="Cleaning"&&e.currentItemStore.currentItem.status==="Available"?(o(),u(m,{key:0,color:"primary",onClick:i.closeTicket},{default:n(()=>[V("Close ticket")]),_:1},8,["onClick"])):C("",!0),r(m,{color:"primary",onClick:l[0]||(l[0]=p=>e.currentItemStore.clearCurrentItem())},{default:n(()=>[V("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Y=w(Q,[["render",X]]),Z={updated(){this.currentItemStore.setLoading(!1)},computed:{...x(L),currentItemSet:function(){return this.currentItemStore.currentItem.id!==void 0&&this.currentItemStore.currentItem.make!==void 0}},methods:{isSingleLine(e){return e.indexOf(`
`)===-1},async orderCleaning(){let e=this.currentItemStore.currentItem;e.status="Cleaning",this.currentItemStore.setCurrentItem(e),await this.$http.patch("/api/vehicle/update",e)},async orderService(){let e=this.currentItemStore.currentItem;e.status="In service",this.currentItemStore.setCurrentItem(e),await this.$http.patch("/api/vehicle/update",e)},async retrieveVehicle(){let e=this.currentItemStore.currentItem;e.status="Available",this.currentItemStore.setCurrentItem(e),await this.$http.patch("/api/vehicle/update",e)}}},ee={class:"text-center d-flex align-center"};function te(e,l,s,v,d,i){const f=t("v-text-field"),_=t("v-textarea"),h=t("v-col"),g=t("v-card-text"),m=t("v-btn"),a=t("v-card-actions"),I=t("v-card"),D=t("v-dialog");return o(),S("div",ee,[r(D,{modelValue:i.currentItemSet,"onUpdate:modelValue":l[1]||(l[1]=p=>i.currentItemSet=p),class:"w-50"},{default:n(()=>[r(I,null,{default:n(()=>[r(g,null,{default:n(()=>[(o(!0),S($,null,T(e.currentItemStore.currentItem,(p,k)=>(o(),u(h,{key:k},{default:n(()=>[i.isSingleLine(String(p))&&k!=="id"?(o(),u(f,{key:0,"model-value":String(p),variant:"outlined",label:k,readonly:""},null,8,["model-value","label"])):k!=="id"?(o(),u(_,{key:1,variant:"outlined","model-value":p,label:k,readonly:""},null,8,["model-value","label"])):C("",!0)]),_:2},1024))),128))]),_:1}),r(a,null,{default:n(()=>[e.currentItemStore.currentItem.status!=="Cleaning"&&e.currentItemStore.currentItem.status==="Available"?(o(),u(m,{key:0,color:"primary",onClick:i.orderCleaning},{default:n(()=>[V("Request cleaning")]),_:1},8,["onClick"])):C("",!0),e.currentItemStore.currentItem.status!=="In service"&&e.currentItemStore.currentItem.status==="Available"?(o(),u(m,{key:1,color:"primary",onClick:i.orderService},{default:n(()=>[V("Request service")]),_:1},8,["onClick"])):C("",!0),e.currentItemStore.currentItem.status!=="Available"?(o(),u(m,{key:2,color:"primary",onClick:i.retrieveVehicle},{default:n(()=>[V("Retrieve vehicle")]),_:1},8,["onClick"])):C("",!0),r(m,{color:"primary",onClick:l[0]||(l[0]=p=>e.currentItemStore.clearCurrentItem())},{default:n(()=>[V("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ne=w(Z,[["render",te]]),re={name:"DashboardView",components:{TicketList:F,VehiclesList:J,TicketDetails:Y,VehicleDetails:ne},data(){return{ticketList:[],vehiclesList:[]}},async created(){}};function oe(e,l,s,v,d,i){const f=t("TicketList"),_=t("v-col"),h=t("VehiclesList"),g=t("v-row"),m=t("TicketDetails"),a=t("VehicleDetails"),I=t("v-container");return o(),u(I,null,{default:n(()=>[r(g,null,{default:n(()=>[r(_,null,{default:n(()=>[r(f)]),_:1}),r(_,null,{default:n(()=>[r(h)]),_:1})]),_:1}),r(m),r(a)]),_:1})}const le=w(re,[["render",oe]]),ae={data(){return{theme:A("dark"),selectedView:"DashboardView"}},components:{DashboardView:le},methods:{onClick(){this.theme=this.theme==="light"?"dark":"light"},changeView(e){console.log(e),this.selectedView=e.id}}};function ce(e,l,s,v,d,i){const f=t("v-btn"),_=t("v-list-item"),h=t("v-list"),g=t("v-divider"),m=t("v-navigation-drawer"),a=t("v-main"),I=t("v-app");return o(),u(I,{theme:d.theme},{default:n(()=>[r(m,{permanent:"",rail:"","expand-on-hover":""},{default:n(()=>[r(h,null,{default:n(()=>[r(_,{"prepend-avatar":"https://randomuser.me/api/portraits/women/85.jpg",title:"Sandra Adams",subtitle:"sandra_a88@gmailcom"},{append:n(()=>[r(f,{class:"ml-5",ripple:!1,variant:"plain",onClick:i.onClick,icon:d.theme==="light"?"mdi-weather-sunny":"mdi-weather-night"},null,8,["onClick","icon"])]),_:1})]),_:1}),r(g),r(h,{density:"compact",nav:"","onClick:select":i.changeView},{default:n(()=>[r(_,{"prepend-icon":"mdi-view-dashboard",title:"Dashboard",value:"DashboardView"})]),_:1},8,["onClick:select"])]),_:1}),r(a,null,{default:n(()=>[(o(),u(q(d.selectedView)))]),_:1})]),_:1},8,["theme"])}const ie=w(ae,[["render",ce]]),se=B({components:K,directives:N});let ue={url:"http://127.0.0.1:8080/",realm:"BRK",clientId:"brk-carshare-client",onLoad:"login-required"},y=new M(ue);y.init({onLoad:"login-required",pkceMethod:"S256",checkLoginIframe:!1}).then(async e=>{if(!e)window.location.reload();else{console.log(y),de(y);const l=U(ie);l.config.globalProperties.$http=P,l.config.globalProperties.$window=window,l.config.globalProperties.$keycloak=y,l.use(j()),l.use(se),l.mount("#administration"),setInterval(()=>{y.updateToken(70).then(s=>{s&&console.log("Token refreshed, valid for  "+Math.round(y.tokenParsed.exp+y.timeSkew-new Date().getTime()/1e3)+" seconds")}).catch(s=>{console.log("Failed to refresh token "+s)})},6e3)}}).catch(e=>{console.log("KeyCloak OnInitError "+e)});function de(e){const l=s=>(s.headers.Authorization=`Bearer ${e.token}`,s.headers.Pragma="no-cache",s);P.interceptors.request.use(l),P.interceptors.response.use(s=>s,s=>{let v=s.response.data;return typeof v=="object"&&v.Message&&(v=v.Message),console.error("Error: "+s+`
Data: `+v),Promise.reject(s)})}
